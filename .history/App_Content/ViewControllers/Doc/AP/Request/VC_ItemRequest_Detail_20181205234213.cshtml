@inherits System.Web.Mvc.WebViewPage
@using System.Web.Mvc;

@{
    Layout = null;
}
@Html.JsMinify(@<text>
//<script>
    define(['app', 'baseModelHelper'], function (app, baseDoc) {

        var VC_ItemRequest_Detail = function () {
      
        }
        
        VC_ItemRequest_Detail.prototype = Object.create(baseDoc.prototype);
          
        VC_ItemRequest_Detail.prototype.Init = function (VC) {

            baseDoc.prototype.Init.call(this, VC);

            var _ = this;
        }

        VC_ItemRequest_Detail.prototype.OnFormInitialized = function (VC) {

            var _ = this;

            var SQL = '@Html.EncryptSQL(@"SELECT * FROM vItemWidthInventoryAndTopSupplier WHERE IsActive = 1 AND ID_Warehouse = @ID_Warehouse ")'

            VC.BrowseDataSet(SQL,
            {
                title: 'Select Items',
                ID_View: '3D89B92F-6D74-40B3-9C39-537D315FCB8D',
                params: {
                    'ID_Item': Enumerable.From(_.CurrentObject.PickList_Details).Select("$.ID_Item").ToArray(),
                }
            }).then(function (Items) {
                
                $.each(Items, function (i, item) {

                    var NewDetail = {
                        
                        ID_Item: item.ID_Item,
                        ItemCode: item.Code,
                        ItemDescription: item.Description,
                        Item: item.Description,
                        Name: item.Description,
                        ID_UOM: item.ID_UOM,
                        UOM: item.UOM,
                        Quantity: 0,
                        BalanceQty: item.Balance,
                        IsSerialized: item.IsSerialized,
                        NonInventoriable: item.NonInventoriable,
                        ID_DocDetail : item.ID_Det,
                        IsSerialized : item.IsSerialized,
                        Conversion : 1,
                    };

                    VC.$timeout(function(){

                        if (_.CurrentObject.PickList_Details == null) _.CurrentObject.PickList_Details = [];

                        VC.$scope.CurrentObject.PickList_Details.push(NewDetail);
                    });

                })

            });


            VC.btnItem.option('onClick', function () {

                

            });
        }
                    
        VC_ItemRequest_Detail.prototype.onLoad = function (VC) {

            baseDoc.prototype.onLoad(this, VC);
        }

        return VC_ItemRequest_Detail;
    });
//</script>
</text> , false )
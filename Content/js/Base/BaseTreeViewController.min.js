define(["baseView"],function(n){"use strict";function t(){}return t.prototype=Object.create(n.prototype),t.prototype.Init=function(t){var i,r;n.prototype.Init.call(this,t);i=this;t.BaseMenuItem=[];t.BaseMenuOption={bindingOptions:{dataSource:"BaseMenuItem"},itemTemplate:function(n,t,r){var f,u;return n.isActionFilter===!0?($(r).parent().parent().css("float","right"),$(r).parent().parent().addClass("jsContextMenuRight"),u=$('<div class="action-filter-container" style="float:right"><div class="action-filter-caption"><span class="'+(n.icon==undefined?"mdi mdi-filter":n.icon)+'"><\/span> '+(n.caption===undefined?"":n.caption)+"<\/div><\/div>"),i.ActionFilters===undefined&&(i.ActionFilters={}),i.ActionFilters[n.name]===undefined&&n.value!==undefined&&(i.ActionFilters==undefined&&(i.ActionFilters={}),i.ActionFilters[n.name]=n.value),f=null,n.searchEnabled=!0,n.SQL!==undefined?(f=new DevExpress.data.DataSource({load:function(t){var f=t.skip==undefined?0:t.skip,r=t.searchValue,e=t.searchExpr!=null?typeof t.searchExpr=="string"?t.searchExpr:t.searchExpr.join():null,u=i.$q.defer();return i.JSDataService.Query(n.SQL,{FilterExpr:r==null?undefined:"Name LIKE '%"+r+"%'"},f).then(function(t){t.collection==null&&(t.collection=[]);n.defaultItems!==undefined&&n.defaultItems!==null&&$.each(n.defaultItems,function(n,i){t.collection.unshift(i)});u.resolve(t.collection)}),u.promise},byKey:function(t){var r=null,u;return(n.defaultItems!==undefined&&(r=Enumerable.From(n.defaultItems).Where("$.ID == "+t).ToArray()[0]),r!==null&&r!==undefined)?r:(u=i.$q.defer(),i.JSDataService.Query(n.SQL,{FilterExpr:"ID = "+t}).then(function(n){if(n.collection.length==0){u.resolve(null);return}u.resolve(n.collection[0])}),u.promise)}}),n.valueExpr="ID",n.displayExpr="Name",n.searchEnabled=!1):f=n.dataSource,$('<div class="action-filter-box"><\/div>').dxSelectBox({dataSource:f,placeholder:n.placeholder,searchEnabled:n.searchEnabled,valueExpr:n.valueExpr==undefined?"id":n.valueExpr,displayExpr:n.displayExpr==undefined?"name":n.displayExpr,width:n.width===undefined?"100px":n.width,value:i.ActionFilters[n.name]===undefined?n.value:i.ActionFilters[n.name],onValueChanged:function(t){i.ActionFilters==undefined&&(i.ActionFilters={});i.ActionFilters[n.name]=t.value;i.OnFilterValueChanged(n.name,t)}}).appendTo(u),u):n.isActionDateRange===!0?(u=$('<div class="action-filter-container"><div class="action-filter-caption"><span class="mdi mdi-calendar"><\/span> '+(n.caption===undefined?"":n.caption)+"<\/div><\/div>"),$("<div><\/div>").jDxDateRangeBox({}).appendTo(u),u):(n.align==="right"&&($(r).parent().parent().css("float","right"),$(r).parent().parent().addClass("jsContextMenuRight")),n.color===undefined&&n.color==null&&(n.color="#767676"),n.icon===undefined&&n.icon==null&&(n.icon="FontInSys"),n.text===undefined)?"<div class='JsContextMenu'><div class='icon-container' style='background:"+n.color+"'><span class='"+n.icon+"'><\/span><\/div><\/div>":"<div class='JsContextMenu' style='display:table-cell;vertical-align:middle;background:transparent'><div class='item-content'><span style='color:"+n.color+"' class='"+n.icon+"'><\/span> <div class='item-caption'>"+n.text+"<\/div><\/div>"},onItemClick:function(n){if(n.itemData.onItemClick!==undefined){n.itemData.onItemClick();return}}};i.Refresh=function(){t.TreeViewData=[];i.JSDataService.Query(i.SQL).then(function(n){$.each(n.collection,function(t,r){r!==null&&(r.items=Enumerable.From(n.collection).Where("$."+i.PropertyKey+" == "+r.ID).ToArray())});t.TreeViewData=Enumerable.From(n.collection).Where("$."+i.PropertyKey+" == null").ToArray();console.log(t.TreeViewData)})};t.SearchTextBoxOption={placeholder:"Search",showClearButton:!0,mode:"search",visible:!0,width:300,onInitialized:function(){}};r=null;t.treeViewMenuOptions={onInitialized:function(n){r=n.component},target:"#none",items:[],onItemClick:function(n){console.log(n.itemData);var u=n.itemData.id,t=r.option("ID_Parent");switch(u){case 1:i.JsPopUpView.OpenDetailView(i.ID_DetailView,{ID_CurrentObject:-1,params:{ID_Parent:t}});break;case 2:i.JsPopUpView.OpenDetailView(i.ID_DetailView,{ID_CurrentObject:t,params:{ID_Parent:null}})}}};t.treeViewOptions={bindingOptions:{dataSource:"TreeViewData"},animationEnabled:!1,onInitialized:function(n){i.TreeView=n.component;i.Refresh()},itemTemplate:function(n){return n.Name},onItemContextMenu:function(n){var t=[],u=n.itemElement,f=u.parent().attr("data-item-id"),i;u.attr("id",f);r.option("target","#"+f);r.option("ID_Parent",n.itemData.ID);i=n.itemData.Name;t.push({id:2,text:"Open "+i,icon:"mdi mdi-open-in-app"});t.push({id:1,text:"Add Item ("+i+")",icon:"mdi mdi-tab-unselected"});r.option("items",t)}};i.ID_DetailView!==undefined&&i.ID_DetailView!==null&&t.BaseMenuItem.push({text:"New",icon:"mdi mdi-file-outline",onItemClick:function(){i.JsPopUpView.OpenDetailView(i.ID_DetailView,{ID_CurrentObject:-1,params:{ID_Parent:null}})}});t.BaseMenuItem.push({text:"Refresh",icon:"mdi mdi-refresh",onItemClick:function(){i.Refresh()}})},t});